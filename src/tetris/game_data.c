#include "game_data.h"

// CONFIGURATIONS
// A block is a 2-dimensional array of configurations on the game board
// To optimize graphics performance, every configuration entry has
// a corresponding blitter configuration. By this means, we can turn
// 4 potential blits (8 with deletions) into a maximum of 2 blits (4
// with deletion)
// Rotation configurations of each block type
struct PieceSpec PIECE_SPECS[] = {
    // I
    {
        PIECE_I,
        {
            // rotation 0
            {
                // tiles
                {
                    { { 0, 1 }, { 1, 1 }, { 2, 1 }, { 3, 1 } },
                    { 4, {0, 1, 2, 3} }
                },
                // draw
                {1, { {RS_1x4, 1, 0} } },
                // outline
                {0, 1, 0, 1, 1, 2},
            },
            // rotation 1
            {
                // tiles
                {
                    { { 2, 0 }, { 2, 1 }, { 2, 2 }, { 2, 3 } },
                    { 1, {3, -1, -1, -1} }
                },
                // draw
                {1, { {RS_4x1, 0, 2} } },
                // outline
                {2, 0, 2, 3, 2, 2}
            },
            // rotation 2
            {
                // tiles
                {
                    { { 0, 2 }, { 1, 2 }, { 2, 2 }, { 3, 2 } },
                    { 4, {0, 1, 2, 3} }
                },
                // draw
                {1, { {RS_1x4, 2, 0} } },
                // outline
                {0, 2, 0, 1, 2, 2},
            },
            // rotation 3
            {
                // tiles
                {
                    { { 1, 0 }, { 1, 1 }, { 1, 2 }, { 1, 3 } },
                    { 1, {3, -1, -1, -1} }
                },
                // draw
                {1, { {RS_4x1, 0, 1} } },
                // outline
                {2, 0, 1, 3, 2, 1}
            }
        }
    },
    // J
    {
        PIECE_J,
        {
            // rotation 0
            {
                // tiles
                {
                    { { 0, 0 }, { 0, 1 }, { 1, 1 }, { 2, 1 } },
                    {3, {1, 2, 3, -1}}
                },
                // draw
                {2, { {RS_1x1, 0, 0}, {RS_1x3, 1, 0} } },
                // outline
                {2, 0, 0, 0, 1, 1}
            },
            // rotation 1
            {
                // tiles
                {
                    { { 1, 0 }, { 1, 1 }, { 2, 0 }, { 1, 2 } },
                    {2, {2, 3, -1, -1}}
                },
                // draw
                {2, { {RS_1x2, 0, 1}, {RS_2x1, 1, 1} } },
                // outline
                {0, 0, 1, 2, 1, 1}
            },
            // rotation 2
            {
                // tiles
                {
                    { { 0, 1 }, { 1, 1 }, { 2, 1 }, { 2, 2 } },
                    {3, {0, 1, 3, -1}}
                },
                // draw
                {2, { {RS_1x2, 1, 0}, {RS_2x1, 1, 2} } },
                // outline
                {0, 1, 0, 2, 1, 2}
            },
            // rotation 3
            {
                // tiles
                {
                    { { 0, 2 }, { 1, 0 }, { 1, 1 }, { 1, 2 } },
                    {2, {0, 3, -1, -1}}
                },
                // draw
                {2, { {RS_2x1, 0, 1}, {RS_1x2, 2, 0} } },
                // outline
                {0, 2, 0, 2, 0, 1}
            }
        }
    },
    // L
    {
        PIECE_L,
        {
            // rotation 0
            {
                // tiles
                {
                    { { 2, 0 }, { 0, 1 }, { 1, 1 }, { 2, 1 } },
                    {3, {1, 2, 3, -1}}
                },
                // draw
                {2, { {RS_1x1, 0, 2}, {RS_1x3, 1, 0} } },
                // outline
                {0, 1, 0, 2, 0, 2}
            },
            // rotation 1
            {
                // tiles
                {
                    { { 1, 0 }, { 1, 1 }, { 1, 2 }, { 2, 2 } },
                    {2, {2, 3, -1, -1}}
                },
                // draw
                {2, { {RS_2x1, 0, 1}, {RS_1x2, 2, 1} } },
                // outline
                {2, 0, 1, 0, 2, 1}
            },
            // rotation 2
            {
                // tiles
                {
                    { { 0, 1 }, { 1, 1 }, { 2, 1 }, { 0, 2 } },
                    {3, {1, 2, 3, -1}}
                },
                // draw
                {2, { {RS_2x1, 1, 0}, {RS_1x2, 1, 1} } },
                // outline
                {2, 1, 0, 0, 1, 1}
            },
            // rotation 3
            {
                // tiles
                {
                    { { 0, 0 }, { 1, 0 }, { 1, 1 }, { 1, 2 } },
                    {2, {0, 3, -1, -1}}
                },
                // draw
                {2, { {RS_1x2, 0, 0}, {RS_2x1, 1, 1} } },
                // outline
                {0, 0, 0, 2, 1, 1}
            }
        }
    },
    // O
    // I placed blit spec into 0,0 instead of 1,1
    // because it can be drawn much more efficiently
    {
        PIECE_O,
        {
            // rotation 0
            {
                // tiles
                {
                    { { 0, 0 }, { 1, 0 }, { 0, 1 }, { 1, 1 } },
                    {2, {2, 3, -1, -1}}
                },
                // draw
                {1, { {RS_2x2, 0, 0}, {0, 0, 0} } },
                // outline
                {0, 0, 0, 1, 1, 0}
            },
            // rotation 1
            {
                // tiles
                {
                    { { 0, 0 }, { 1, 0 }, { 0, 1 }, { 1, 1 } },
                    {2, {2, 3, -1, -1}}
                },
                // draw
                {1, { {RS_2x2, 0, 0}, {0, 0, 0} } },
                // outline
                {0, 0, 0, 1, 1, 0}
            },
            // rotation 2
            {
                // tiles
                {
                    { { 0, 0 }, { 1, 0 }, { 0, 1 }, { 1, 1 } },
                    {2, {2, 3, -1, -1}}
                },
                // draw
                {1, { {RS_2x2, 0, 0}, {0, 0, 0} } },
                // outline
                {0, 0, 0, 1, 1, 0}
            },
            // rotation 3
            {
                // tiles
                {
                    { { 0, 0 }, { 1, 0 }, { 0, 1 }, { 1, 1 } },
                    {2, {2, 3, -1, -1}}
                },
                // draw
                {1, { {RS_2x2, 0, 0}, {0, 0, 0} } },
                // outline
                {0, 0, 0, 1, 1, 0}
            }
        }
    },
    // S
    {
        PIECE_S,
        {
            // rotation 0
            {
                // tiles
                {
                    { { 1, 0 }, { 2, 0 }, { 0, 1 }, { 1, 1 } },
                    {3, {1, 2, 3, -1}}
                },
                // draw
                {2, { {RS_1x2, 0, 1}, {RS_1x2, 1, 0} } },
                // outline
                {0, 0, 1, 1, 1, 0}
            },
            // rotation 1
            {
                // tiles
                {
                    { { 1, 0 }, { 1, 1 }, { 2, 1 }, { 2, 2 } },
                    {2, {1, 3, -1, -1}}
                },
                // draw
                {2, { {RS_2x1, 0, 1}, {RS_2x1, 1, 2} } },
                // outline
                {2, 0, 1, 3, 1, 2}
            },
            // rotation 2
            {
                // tiles
                {
                    { { 1, 1 }, { 2, 1 }, { 0, 2 }, { 1, 2 } },
                    {3, {1, 2, 3, -1}}
                },
                // draw
                {2, { {RS_1x2, 1, 1}, {RS_1x2, 2, 0} } },
                // outline
                {0, 1, 1, 1, 2, 0}
            },
            // rotation 3
            {
                // tiles
                {
                    { { 0, 0 }, { 0, 1 }, { 1, 1 }, { 1, 2 } },
                    {2, {1, 3, -1, -1}}
                },
                // draw
                {2, { {RS_2x1, 0, 0}, {RS_2x1, 1, 1} } },
                // outline
                {2, 0, 0, 3, 1, 1}
            }
        }
    },
    // T
    {
        PIECE_T,
        {
            // rotation 0
            {
                // tiles
                {
                    { { 1, 0 }, { 0, 1 }, { 1, 1 }, { 2, 1 } },
                    {3, {1, 2, 3, -1}}
                },
                // draw
                {2, { {RS_1x1, 0, 1}, {RS_1x3, 1, 0} } },
                // outline
                {4, 1, 0, 6, 0, 1}
            },
            // rotation 1
            {
                // tiles
                {
                    { { 1, 0 }, { 1, 1 }, { 2, 1 }, { 1, 2 } },
                    {2, {2, 3, -1, -1}}
                },
                // draw
                {2, { {RS_3x1, 0, 1}, {RS_1x1, 1, 2} } },
                // outline
                {6, 0, 1, 4, 2, 1}
            },
            // rotation 2
            {
                // tiles
                {
                    { { 0, 1 }, { 1, 1 }, { 2, 1 }, { 1, 2 } },
                    {3, {0, 2, 3, -1}}
                },
                // draw
                {2, { {RS_1x3, 1, 0}, {RS_1x1, 2, 1} } },
                // outline
                {5, 1, 0, 4, 1, 2}
            },
            // rotation 3
            {
                // tiles
                {
                    { { 0, 1 }, { 1, 0 }, { 1, 1 }, { 1, 2 } },
                    {2, {0, 3, -1, -1}}
                },
                // draw
                {2, { {RS_1x1, 1, 0}, {RS_3x1, 0, 1} } },
                // outline
                {4, 0, 1, 5, 1, 0}
            }
        }
    },
    // Z
    {
        PIECE_Z,
        {
            // rotation 0
            {
                // tiles
                {
                    { { 0, 0 }, { 1, 0 }, { 1, 1 }, { 2, 1 } },
                    {3, {0, 2, 3, -1}}
                },
                // draw
                {2, { {RS_1x2, 0, 0}, {RS_1x2, 1, 1} } },
                // outline
                {0, 0, 0, 1, 1, 1}
            },
            // rotation 1
            {
                // tiles
                {
                    { { 2, 0 }, { 2, 1 }, { 1, 1 }, { 1, 2 } },
                    {2, {1, 3, -1, -1}}
                },
                // draw
                {2, { {RS_2x1, 1, 1}, {RS_2x1, 0, 2} } },
                // outline
                {2, 1, 1, 3, 0, 2}
            },
            // rotation 2
            {
                // tiles
                {
                    { { 0, 1 }, { 1, 1 }, { 1, 2 }, { 2, 2 } },
                    {3, {0, 2, 3, -1}}
                },
                // draw
                {2, { {RS_1x2, 1, 0}, {RS_1x2, 2, 1} } },
                // outline
                {0, 1, 0, 1, 2, 1},
            },
            // rotation 3
            {
                // tiles
                {
                    { { 1, 0 }, { 1, 1 }, { 0, 1 }, { 0, 2 } },
                    {2, {1, 3, -1, -1}}
                },
                // draw
                {2, { {RS_2x1, 1, 0}, {RS_2x1, 0, 1} } },
                // outline
                {2, 1, 0, 3, 0, 1}
            }
        }
    }
};



// KICK DATA
struct Translate WALLKICK_JLTSZ[NUM_FROM_ROTATIONS][NUM_TO_ROTATIONS][NUM_WALLKICK_TESTS] = {
    // rotation 0
    {
        {{0, 0}, {-1, 0}, {-1, 1}, {0, -2}, {-1, -2}}, // >> 1
        {{0, 0}, {1, 0}, {1, 1}, {0, -2}, {1, -2}} // >> 3
    },
    // rotation 1
    {
        {{0, 0}, {1, 0}, {1, -1}, {0, 2}, {1, 2}}, // >> 2
        {{0, 0}, {1, 0}, {1, -1}, {0, 2}, {1, 2}} // >> 0
    },
    // rotation 2
    {
        {{0, 0}, {-1, 0}, {-1, 1}, {0, -2}, {-1, -2}}, // >> 3
        {{0, 0}, {1, 0}, {1, 1}, {0, -2}, {1, -2}} // >> 1
    },
    // rotation 3
    {
        {{0, 0}, {-1, 0}, {-1, -1}, {0, 2}, {-1, 2}}, // >> 0
        {{0, 0}, {-1, 0}, {-1, -1}, {0, 2}, {-1, 2}} // >> 2
    }
};

struct Translate WALLKICK_I[NUM_FROM_ROTATIONS][NUM_TO_ROTATIONS][NUM_WALLKICK_TESTS] = {
    // rotation 0
    {
        {{0, 0}, {-2, 0}, {1, 0}, {-2, -1}, {1, 2}}, // >> 1
        {{0, 0}, {-1, 0}, {2, 0}, {-1, 2}, {2, -1}} // >> 3
    },
    // rotation 1
    {
        {{0, 0}, {-1, 0}, {2, 0}, {-1, 2}, {2, -1}}, // >> 2
        {{0, 0}, {2, 0}, {-1, 0}, {2, 1}, {-1, -2}} // >> 0
    },
    // rotation 2
    {
        {{0, 0}, {2, 0}, {-1, 0}, {2, 1}, {-1, -2}}, // >> 3
        {{0, 0}, {1, 0}, {-2, 0}, {1, -2}, {-2, 1}} // >> 1
    },
    // rotation 3
    {
        {{0, 0}, {1, 0}, {-2, 0}, {1, -2}, {-2, 1}}, // >> 0
        {{0, 0}, {-2, 0}, {1, 0}, {-2, -1}, {1, 2}} // >> 2
    }
};
